/* ===== ULTRA-MODERN COMPACT SIDEBAR 2025 ===== */

/* Fixed sidebar container - Like chat input but vertical */
.compact-sidebar-fixed {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  z-index: 40 !important;
  background: rgba(255, 255, 255, 0.95) !important;
  backdrop-filter: blur(20px) !important;
  border-right: 1px solid rgba(229, 231, 235, 0.5) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12) !important;
  transition: all 0.3s ease !important;
  display: flex !important;
  flex-direction: column !important;
  height: 100vh !important;
}

/* Dark mode moderno e sofisticado para sidebar compacta */
.dark .compact-sidebar-fixed {
  background: linear-gradient(180deg, hsl(240 10% 4% / 0.98) 0%, hsl(240 10% 3% / 0.98) 100%) !important;
  border-right: 1px solid hsl(240 10% 10% / 0.3) !important;
  box-shadow: 0 8px 32px hsl(0 0% 0% / 0.4), 0 0 0 1px hsl(240 10% 12% / 0.1) !important;
  backdrop-filter: blur(25px) !important;
}

/* Collapsed state - Ultra compact */
.compact-sidebar-fixed.collapsed {
  width: clamp(56px, 52px + 0.5vw, 64px) !important;
}

/* Expanded state - More compact width */
.compact-sidebar-fixed.expanded {
  width: clamp(220px, 200px + 2vw, 240px) !important;
}

/* Header styling - More compact */
.compact-sidebar-header {
  padding: clamp(6px, 5px + 0.2vw, 8px) !important;
  border-bottom: 1px solid rgba(229, 231, 235, 0.5) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  flex-shrink: 0 !important;
  min-height: clamp(44px, 42px + 0.3vw, 48px) !important;
}

/* Header when collapsed - center logo */
.compact-sidebar-fixed.collapsed .compact-sidebar-header {
  justify-content: center !important;
  padding: clamp(10px, 9px + 0.2vw, 12px) clamp(5px, 4px + 0.1vw, 6px) !important;
}

/* Logo container */
.compact-sidebar-logo {
  display: flex !important;
  align-items: center !important;
  gap: clamp(6px, 5px + 0.2vw, 8px) !important;
}

/* Logo when collapsed - center it */
.compact-sidebar-fixed.collapsed .compact-sidebar-logo {
  justify-content: center !important;
  width: 100% !important;
}

/* Logo image */
.compact-sidebar-logo img {
  height: clamp(24px, 22px + 0.3vw, 28px) !important;
  width: auto !important;
}

/* Logo text */
.compact-sidebar-logo-text {
  font-size: clamp(14px, 13px + 0.2vw, 16px) !important;
  font-weight: 700 !important;
  line-height: 1 !important;
}

/* Toggle button - Modern rounded */
.compact-sidebar-toggle {
  padding: clamp(6px, 5px + 0.2vw, 8px) !important;
  border-radius: clamp(10px, 9px + 0.2vw, 12px) !important;
  background: transparent !important;
  border: none !important;
  transition: all 0.2s ease !important;
  cursor: pointer !important;
}

.compact-sidebar-toggle:hover {
  background: rgba(243, 244, 246, 0.8) !important;
  transform: scale(1.05) !important;
}

/* Navigation styling - More compact */
.compact-sidebar-nav {
  flex: 1 !important;
  padding: clamp(6px, 5px + 0.2vw, 8px) !important;
  display: flex !important;
  flex-direction: column !important;
  gap: clamp(4px, 3px + 0.2vw, 6px) !important;
  overflow-y: auto !important;
  min-height: 0 !important;
  max-height: calc(100vh - 120px) !important;
}

/* Navigation items - More compact */
.compact-sidebar-item {
  width: 100% !important;
  display: flex !important;
  align-items: center !important;
  gap: clamp(6px, 5px + 0.2vw, 8px) !important;
  padding: clamp(6px, 5px + 0.2vw, 8px) clamp(8px, 7px + 0.2vw, 10px) !important;
  border-radius: clamp(6px, 5px + 0.2vw, 8px) !important;
  transition: all 0.2s ease !important;
  cursor: pointer !important;
  border: none !important;
  background: transparent !important;
  text-decoration: none !important;
}

.compact-sidebar-item:hover {
  background: rgba(243, 244, 246, 0.8) !important;
  transform: scale(1.02) !important;
}

/* Active state - Gradient background */
.compact-sidebar-item.active {
  background: linear-gradient(135deg, rgba(253, 230, 138, 0.2), rgba(251, 191, 36, 0.2)) !important;
  border: 1px solid rgba(253, 230, 138, 0.3) !important;
  box-shadow: 0 2px 8px rgba(253, 230, 138, 0.2) !important;
}

/* Item icons */
.compact-sidebar-item-icon {
  width: clamp(16px, 15px + 0.2vw, 18px) !important;
  height: clamp(16px, 15px + 0.2vw, 18px) !important;
  flex-shrink: 0 !important;
}

/* Item text */
.compact-sidebar-item-text {
  font-weight: 500 !important;
  font-size: clamp(12px, 11px + 0.2vw, 13px) !important;
  line-height: 1 !important;
}

/* Collapsed state - Center icons */
.compact-sidebar-fixed.collapsed .compact-sidebar-item {
  justify-content: center !important;
  padding: clamp(8px, 7px + 0.2vw, 10px) !important;
}

.compact-sidebar-fixed.collapsed .compact-sidebar-item-text {
  display: none !important;
}

/* User profile section - More compact */
.compact-sidebar-user {
  padding: 8px !important;
  border-top: 1px solid rgba(229, 231, 235, 0.5) !important;
  margin-top: auto !important;
  position: sticky !important;
  bottom: 0 !important;
  background: rgba(255, 255, 255, 0.95) !important;
  backdrop-filter: blur(20px) !important;
  flex-shrink: 0 !important;
  min-height: 48px !important;
}

/* Content offset - Dynamic adjustment */
.compact-sidebar-offset {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  min-height: 100vh !important;
}

.compact-sidebar-offset.collapsed {
  margin-left: 64px !important;
}

.compact-sidebar-offset.expanded {
  margin-left: 240px !important;
}

/* Ensure content doesn't get hidden behind sidebar */
body {
  margin-left: 0 !important;
  padding-left: 0 !important;
  overflow-x: hidden !important; /* Prevenir scroll horizontal */
}

/* Mobile: garantir que não há overflow horizontal */
@media (max-width: 767px) {
  body {
    overflow-x: hidden !important;
  }
  
  html {
    overflow-x: hidden !important;
  }
}

/* Main content area adjustment - Direct approach */
.main-content-with-sidebar {
  transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  margin-left: 64px !important; /* Default collapsed state */
  width: calc(100vw - 64px) !important;
  overflow-x: hidden !important;
  min-height: 100vh !important; /* Ensure content is always visible */
}

/* When sidebar is expanded */
body.sidebar-expanded .main-content-with-sidebar {
  margin-left: 240px !important;
  width: calc(100vw - 240px) !important;
}

/* Ensure content is always visible - fallback rules */
body.sidebar-collapsed .main-content-with-sidebar {
  margin-left: 64px !important;
  width: calc(100vw - 64px) !important;
  min-height: 100vh !important;
  background: transparent !important;
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
}

/* Force all content to be visible when sidebar is collapsed */
body.sidebar-collapsed .main-content-with-sidebar * {
  opacity: 1 !important;
  visibility: visible !important;
  display: inherit !important;
}

/* Force visibility for all states */
.main-content-with-sidebar {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  position: relative !important;
  z-index: 1 !important;
  background: transparent !important;
}

/* Ensure content inside main area is visible */
.main-content-with-sidebar > * {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
}

/* Specific fixes for chat and enem pages */
.main-content-with-sidebar .bg-gradient-to-br {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
  min-height: 100vh !important;
}

.main-content-with-sidebar .flex-1 {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
}

/* Force visibility for all divs inside main content */
.main-content-with-sidebar div {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Specific fix for chat component structure */
.main-content-with-sidebar .bg-gradient-to-br.from-slate-50 {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
  min-height: 100vh !important;
  width: 100% !important;
}

/* Ensure flex containers are visible */
.main-content-with-sidebar .flex {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
}

/* Ensure flex-1 containers are visible */
.main-content-with-sidebar .flex-1 {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
  flex: 1 !important;
}

/* Mobile responsive - sidebar hidden by default, opens from left when triggered by header */
@media (max-width: 767px) {
  .main-content-with-sidebar {
    margin-left: 0 !important; /* Sem margem em mobile por padrão */
    padding-top: 0 !important;
    width: 100vw !important; /* Largura total em mobile */
    overflow-x: hidden !important;
  }
  
  body.sidebar-collapsed .main-content-with-sidebar {
    margin-left: 0 !important;
    width: 100vw !important;
  }
  
  body.sidebar-expanded .main-content-with-sidebar {
    margin-left: 0 !important; /* Quando expandida, ocupa toda a tela com overlay */
    width: 100vw !important;
  }
  
  /* Sidebar hidden by default in mobile, positioned on left */
  .compact-sidebar-fixed {
    width: 64px !important;
    z-index: 1000 !important;
    transform: translateX(-100%) !important; /* Escondida por padrão (fora da tela à esquerda) */
    transition: transform 0.3s ease !important;
    left: 0 !important; /* Posicionada à esquerda */
    right: auto !important;
  }
  
  .compact-sidebar-fixed.expanded {
    width: 240px !important;
    z-index: 1001 !important;
    transform: translateX(0) !important; /* Visível quando expandida (desliza da esquerda para direita) */
  }
  
  /* Overlay mais escuro quando expandida em mobile */
  .compact-sidebar-overlay {
    background: rgba(0, 0, 0, 0.4) !important;
    backdrop-filter: blur(8px) !important;
  }
}

/* Tablet adjustments - sidebar sempre visível */
@media (min-width: 768px) and (max-width: 1023px) {
  .compact-sidebar-fixed {
    transform: none !important; /* Sem transform em tablet */
    left: 0 !important;
    right: auto !important;
  }
  
  .compact-sidebar-fixed.collapsed {
    width: 64px !important;
    transform: none !important;
  }
  
  .compact-sidebar-fixed.expanded {
    width: 220px !important; /* Largura menor para tablet */
    transform: none !important;
  }
  
  /* Ajustar conteúdo para tablet */
  .main-content-with-sidebar {
    margin-left: 64px !important;
    width: calc(100vw - 64px) !important;
  }
  
  body.sidebar-expanded .main-content-with-sidebar {
    margin-left: 220px !important;
    width: calc(100vw - 220px) !important;
  }
}

/* Desktop - garantir que funcione corretamente */
@media (min-width: 1024px) {
  .compact-sidebar-fixed {
    transform: none !important; /* Remover transform em desktop */
    left: 0 !important;
    right: auto !important;
  }
  
  .compact-sidebar-fixed.collapsed {
    width: 64px !important;
    transform: none !important;
  }
  
  .compact-sidebar-fixed.expanded {
    width: 240px !important;
    transform: none !important;
  }
}

/* Mobile overlay - Modern blur */
.compact-sidebar-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: rgba(0, 0, 0, 0.2) !important;
  backdrop-filter: blur(4px) !important;
  z-index: 40 !important;
}


/* Tablet adjustments */
@media (min-width: 768px) and (max-width: 1023px) {
  .compact-sidebar-fixed.expanded {
    width: 220px !important;
  }
}

/* Desktop optimizations */
@media (min-width: 1024px) {
  .compact-sidebar-fixed {
    width: 64px !important;
  }
  
  .compact-sidebar-fixed.expanded {
    width: 240px !important;
  }
}

/* Smooth transitions */
.compact-sidebar-fixed,
.compact-sidebar-offset,
.compact-sidebar-item {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* Focus states for accessibility */
.compact-sidebar-item:focus {
  outline: 2px solid hsl(45 100% 60%) !important;
  outline-offset: 2px !important;
}

.compact-sidebar-toggle:focus {
  outline: 2px solid hsl(45 100% 60%) !important;
  outline-offset: 2px !important;
}

/* Hover effects */
.compact-sidebar-item:hover {
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

/* Active item styling */
.compact-sidebar-item.active {
  color: #ca8a04 !important;
}

.compact-sidebar-item.active .compact-sidebar-item-icon {
  color: #ca8a04 !important;
}

/* Modern shadows */
.compact-sidebar-fixed {
  box-shadow: 
    0 4px 6px -1px rgba(0, 0, 0, 0.1),
    0 2px 4px -1px rgba(0, 0, 0, 0.06),
    0 0 0 1px rgba(255, 255, 255, 0.05) !important;
}

/* Glass morphism effect */
.compact-sidebar-fixed {
  background: rgba(255, 255, 255, 0.8) !important;
  backdrop-filter: blur(20px) !important;
  -webkit-backdrop-filter: blur(20px) !important;
}

/* Ensure proper z-index stacking */
.compact-sidebar-fixed {
  z-index: 1000 !important;
}

/* Ensure clickable elements are above everything */
.compact-sidebar-item,
.compact-sidebar-toggle {
  z-index: 1001 !important;
  position: relative !important;
}

/* Fix pointer events */
.compact-sidebar-item:not(:disabled) {
  pointer-events: auto !important;
}

/* User profile dropdown positioning */
.compact-sidebar-user {
  position: relative !important;
  flex-shrink: 0 !important;
}

/* Ensure dropdown opens upward and to the right in sidebar */
.compact-sidebar-user .user-profile-dropdown {
  position: absolute !important;
  bottom: 100% !important;
  left: 0 !important;
  margin-bottom: 8px !important;
  z-index: 1000 !important;
  width: 280px !important;
  max-width: calc(100vw - 80px) !important;
}

/* UserProfile styling in sidebar */
.compact-sidebar-user .user-profile {
  width: 100% !important;
  justify-content: center !important;
}

.compact-sidebar-fixed.collapsed .compact-sidebar-user .user-profile {
  justify-content: center !important;
}

/* Dropdown animations */
.user-profile-dropdown {
  animation: slideUpRight 0.2s ease-out !important;
}

@keyframes slideUpRight {
  from {
    opacity: 0 !important;
    transform: translateY(10px) translateX(-10px) !important;
  }
  to {
    opacity: 1 !important;
    transform: translateY(0) translateX(0) !important;
  }
}

/* Logo as button when collapsed */
.compact-sidebar-fixed.collapsed .compact-sidebar-logo.compact-sidebar-toggle {
  background: transparent !important;
  border: none !important;
  padding: 8px !important;
  border-radius: 12px !important;
  transition: all 0.2s ease !important;
  cursor: pointer !important;
  justify-content: center !important;
  width: 100% !important;
}

.compact-sidebar-fixed.collapsed .compact-sidebar-logo.compact-sidebar-toggle:hover {
  background: rgba(243, 244, 246, 0.8) !important;
  transform: scale(1.05) !important;
}

/* Ensure content is always visible */
.main-content-with-sidebar {
  min-height: 100vh !important;
  width: calc(100vw - 64px) !important;
  overflow-x: hidden !important;
}

body.sidebar-expanded .main-content-with-sidebar {
  width: calc(100vw - 240px) !important;
}

/* Mobile: Full width quando sidebar expandida */
@media (max-width: 1023px) {
  .main-content-with-sidebar {
    width: calc(100vw - 64px) !important; /* Largura total menos sidebar collapsed */
  }
  
  body.sidebar-expanded .main-content-with-sidebar {
    width: 100vw !important; /* Largura total quando expandida */
  }
}
