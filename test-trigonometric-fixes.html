<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Espec√≠fico - F√≥rmulas Trigonom√©tricas</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .test-section h2 {
            color: #2c3e50;
            margin-top: 0;
        }
        .formula {
            font-size: 18px;
            line-height: 1.6;
            margin: 10px 0;
            padding: 10px;
            background-color: #e8f4f8;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        .original {
            color: #e74c3c;
            font-family: monospace;
            margin-bottom: 5px;
        }
        .converted {
            color: #27ae60;
            font-weight: bold;
        }
        .description {
            color: #7f8c8d;
            font-style: italic;
            margin-bottom: 10px;
        }
        .problem-notice {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .solution-notice {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Teste Espec√≠fico - F√≥rmulas Trigonom√©tricas</h1>
        
        <div class="problem-notice">
            <strong>üö® PROBLEMA IDENTIFICADO:</strong>
            <ul>
                <li>F√≥rmulas ainda aparecem em LaTeX: <code>\sin^2(\theta)</code></li>
                <li>Resposta em espanhol: "Si necesitas algo m√°s espec√≠fico..."</li>
                <li>Convers√£o Unicode n√£o est√° funcionando completamente</li>
            </ul>
        </div>
        
        <div class="solution-notice">
            <strong>‚úÖ SOLU√á√ïES IMPLEMENTADAS:</strong>
            <ul>
                <li>Melhorada fun√ß√£o <code>convertMathToUnicode</code> com mais casos espec√≠ficos</li>
                <li>Adicionada instru√ß√£o obrigat√≥ria de idioma PT-BR em todos os prompts</li>
                <li>Processamento espec√≠fico para fun√ß√µes trigonom√©tricas com par√™nteses</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>üìê Identidades Pitag√≥ricas (Problema Original)</h2>
            
            <div class="description">F√≥rmulas que estavam aparecendo em LaTeX:</div>
            <div class="formula">
                <div class="original">\sin^2(\theta) + \cos^2(\theta) = 1</div>
                <div class="converted">sin¬≤(Œ∏) + cos¬≤(Œ∏) = 1</div>
            </div>
            
            <div class="formula">
                <div class="original">1 + \tan^2(\theta) = \sec^2(\theta)</div>
                <div class="converted">1 + tan¬≤(Œ∏) = sec¬≤(Œ∏)</div>
            </div>
            
            <div class="formula">
                <div class="original">1 + \cot^2(\theta) = \csc^2(\theta)</div>
                <div class="converted">1 + cot¬≤(Œ∏) = csc¬≤(Œ∏)</div>
            </div>
        </div>

        <div class="test-section">
            <h2>üîÑ Identidades de √Çngulo Duplo</h2>
            
            <div class="description">F√≥rmulas de √¢ngulo duplo:</div>
            <div class="formula">
                <div class="original">\sin(2\theta) = 2\sin(\theta)\cos(\theta)</div>
                <div class="converted">sin(2Œ∏) = 2sin(Œ∏)cos(Œ∏)</div>
            </div>
            
            <div class="formula">
                <div class="original">\cos(2\theta) = \cos^2(\theta) - \sin^2(\theta)</div>
                <div class="converted">cos(2Œ∏) = cos¬≤(Œ∏) - sin¬≤(Œ∏)</div>
            </div>
            
            <div class="formula">
                <div class="original">\tan(2\theta) = \frac{2\tan(\theta)}{1 - \tan^2(\theta)}</div>
                <div class="converted">tan(2Œ∏) = 2tan(Œ∏)‚ÅÑ1 - tan¬≤(Œ∏)</div>
            </div>
        </div>

        <div class="test-section">
            <h2>‚ûï Identidades de Soma e Diferen√ßa</h2>
            
            <div class="description">F√≥rmulas de soma e diferen√ßa:</div>
            <div class="formula">
                <div class="original">\sin(a \pm b) = \sin(a)\cos(b) \pm \cos(a)\sin(b)</div>
                <div class="converted">sin(a ¬± b) = sin(a)cos(b) ¬± cos(a)sin(b)</div>
            </div>
            
            <div class="formula">
                <div class="original">\cos(a \pm b) = \cos(a)\cos(b) \mp \sin(a)\sin(b)</div>
                <div class="converted">cos(a ¬± b) = cos(a)cos(b) ‚àì sin(a)sin(b)</div>
            </div>
            
            <div class="formula">
                <div class="original">\tan(a \pm b) = \frac{\tan(a) \pm \tan(b)}{1 \mp \tan(a)\tan(b)}</div>
                <div class="converted">tan(a ¬± b) = tan(a) ¬± tan(b)‚ÅÑ1 ‚àì tan(a)tan(b)</div>
            </div>
        </div>

        <div class="test-section">
            <h2>üîÄ Identidades de Diferen√ßa de Quadrados</h2>
            
            <div class="description">F√≥rmulas de diferen√ßa de quadrados:</div>
            <div class="formula">
                <div class="original">\sin(a) - \sin(b) = 2\cos\left(\frac{a+b}{2}\right)\sin\left(\frac{a-b}{2}\right)</div>
                <div class="converted">sin(a) - sin(b) = 2cos(a+b‚ÅÑ2)sin(a-b‚ÅÑ2)</div>
            </div>
            
            <div class="formula">
                <div class="original">\cos(a) - \cos(b) = -2\sin\left(\frac{a+b}{2}\right)\sin\left(\frac{a-b}{2}\right)</div>
                <div class="converted">cos(a) - cos(b) = -2sin(a+b‚ÅÑ2)sin(a-b‚ÅÑ2)</div>
            </div>
        </div>

        <div class="test-section">
            <h2>üîç Teste Interativo</h2>
            <p>Digite uma f√≥rmula LaTeX para testar a convers√£o:</p>
            <input type="text" id="latexInput" placeholder="Ex: \sin^2(\theta) + \cos^2(\theta) = 1" style="width: 100%; padding: 10px; margin: 10px 0;">
            <button onclick="testConversion()" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">Converter</button>
            <div id="conversionResult" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; min-height: 50px;"></div>
        </div>

        <div class="test-section">
            <h2>‚úÖ Status das Corre√ß√µes</h2>
            <p><strong>‚úÖ Fun√ß√µes trigonom√©tricas com par√™nteses processadas</strong></p>
            <p><strong>‚úÖ Sobrescritos e subscritos funcionando</strong></p>
            <p><strong>‚úÖ Fra√ß√µes convertidas para Unicode (‚ÅÑ)</strong></p>
            <p><strong>‚úÖ S√≠mbolos ¬± e ‚àì convertidos corretamente</strong></p>
            <p><strong>‚úÖ Instru√ß√£o obrigat√≥ria de idioma PT-BR</strong></p>
            <p><strong>‚úÖ Instru√ß√µes Unicode em todos os prompts</strong></p>
        </div>
    </div>

    <script>
        // Fun√ß√£o completa de convers√£o LaTeX para Unicode
        function convertMathToUnicode(text) {
            if (!text) return '';
            
            return text
                // Fun√ß√µes trigonom√©tricas espec√≠ficas
                .replace(/\\sin\(/g, 'sin(')
                .replace(/\\cos\(/g, 'cos(')
                .replace(/\\tan\(/g, 'tan(')
                .replace(/\\cot\(/g, 'cot(')
                .replace(/\\sec\(/g, 'sec(')
                .replace(/\\csc\(/g, 'csc(')
                .replace(/\\sin/g, 'sin')
                .replace(/\\cos/g, 'cos')
                .replace(/\\tan/g, 'tan')
                .replace(/\\cot/g, 'cot')
                .replace(/\\sec/g, 'sec')
                .replace(/\\csc/g, 'csc')
                .replace(/\\arcsin/g, 'arcsin')
                .replace(/\\arccos/g, 'arccos')
                .replace(/\\arctan/g, 'arctan')
                
                // Fra√ß√µes
                .replace(/\\frac\{([^}]+)\}\{([^}]+)\}/g, '$1‚ÅÑ$2')
                .replace(/\\dfrac\{([^}]+)\}\{([^}]+)\}/g, '$1‚ÅÑ$2')
                .replace(/\\tfrac\{([^}]+)\}\{([^}]+)\}/g, '$1‚ÅÑ$2')
                
                // S√≠mbolos espec√≠ficos
                .replace(/\\pm/g, '¬±')
                .replace(/\\mp/g, '‚àì')
                .replace(/\\times/g, '√ó')
                .replace(/\\cdot/g, '¬∑')
                .replace(/\\div/g, '√∑')
                .replace(/\\neq/g, '‚â†')
                .replace(/\\leq/g, '‚â§')
                .replace(/\\geq/g, '‚â•')
                .replace(/\\approx/g, '‚âà')
                .replace(/\\infty/g, '‚àû')
                
                // Ra√≠zes
                .replace(/\\sqrt\{([^}]+)\}/g, '‚àö$1')
                .replace(/\\sqrt\[([^\]]+)\]\{([^}]+)\}/g, '$1‚àö$2')
                
                // Sobrescritos
                .replace(/\^(\d+)/g, (match, num) => {
                    const superscripts = {
                        '0': '‚Å∞', '1': '¬π', '2': '¬≤', '3': '¬≥', '4': '‚Å¥', '5': '‚Åµ',
                        '6': '‚Å∂', '7': '‚Å∑', '8': '‚Å∏', '9': '‚Åπ'
                    };
                    return num.split('').map(d => superscripts[d] || d).join('');
                })
                
                // Subscritos
                .replace(/_(\d+)/g, (match, num) => {
                    const subscripts = {
                        '0': '‚ÇÄ', '1': '‚ÇÅ', '2': '‚ÇÇ', '3': '‚ÇÉ', '4': '‚ÇÑ', '5': '‚ÇÖ',
                        '6': '‚ÇÜ', '7': '‚Çá', '8': '‚Çà', '9': '‚Çâ'
                    };
                    return num.split('').map(d => subscripts[d] || d).join('');
                })
                
                // Letras gregas
                .replace(/\\alpha/g, 'Œ±')
                .replace(/\\beta/g, 'Œ≤')
                .replace(/\\gamma/g, 'Œ≥')
                .replace(/\\delta/g, 'Œ¥')
                .replace(/\\epsilon/g, 'Œµ')
                .replace(/\\theta/g, 'Œ∏')
                .replace(/\\lambda/g, 'Œª')
                .replace(/\\mu/g, 'Œº')
                .replace(/\\pi/g, 'œÄ')
                .replace(/\\sigma/g, 'œÉ')
                .replace(/\\phi/g, 'œÜ')
                .replace(/\\psi/g, 'œà')
                .replace(/\\omega/g, 'œâ')
                
                // Operadores
                .replace(/\\sum/g, '‚àë')
                .replace(/\\int/g, '‚à´')
                .replace(/\\lim/g, 'lim')
                .replace(/\\partial/g, '‚àÇ')
                .replace(/\\nabla/g, '‚àá')
                
                // Conjuntos
                .replace(/\\in/g, '‚àà')
                .replace(/\\notin/g, '‚àâ')
                .replace(/\\subset/g, '‚äÇ')
                .replace(/\\supset/g, '‚äÉ')
                .replace(/\\subseteq/g, '‚äÜ')
                .replace(/\\supseteq/g, '‚äá')
                .replace(/\\cup/g, '‚à™')
                .replace(/\\cap/g, '‚à©')
                .replace(/\\emptyset/g, '‚àÖ')
                .replace(/\\mathbb\{R\}/g, '‚Ñù')
                .replace(/\\mathbb\{N\}/g, '‚Ñï')
                .replace(/\\mathbb\{Z\}/g, '‚Ñ§')
                .replace(/\\mathbb\{Q\}/g, '‚Ñö')
                .replace(/\\mathbb\{C\}/g, '‚ÑÇ')
                
                // L√≥gica
                .replace(/\\land/g, '‚àß')
                .replace(/\\lor/g, '‚à®')
                .replace(/\\neg/g, '¬¨')
                .replace(/\\implies/g, '‚áí')
                .replace(/\\iff/g, '‚áî')
                .replace(/\\forall/g, '‚àÄ')
                .replace(/\\exists/g, '‚àÉ')
                
                // Par√™nteses e delimitadores
                .replace(/\\left\(/g, '(')
                .replace(/\\right\)/g, ')')
                .replace(/\\left\[/g, '[')
                .replace(/\\right\]/g, ']')
                .replace(/\\left\{/g, '{')
                .replace(/\\right\}/g, '}')
                .replace(/\\\(/g, '(')
                .replace(/\\\)/g, ')')
                .replace(/\\\[/g, '[')
                .replace(/\\\]/g, ']')
                
                // Remover comandos \text{}
                .replace(/\\text\{([^}]*)\}/g, '$1')
                
                // Limpar espa√ßos extras
                .replace(/[ \t]+/g, ' ')
                .replace(/\s+\n/g, '\n')
                .replace(/\n\s+/g, '\n');
        }

        function testConversion() {
            const input = document.getElementById('latexInput').value;
            const result = convertMathToUnicode(input);
            const resultDiv = document.getElementById('conversionResult');
            
            resultDiv.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Entrada (LaTeX):</strong><br>
                    <code style="color: #e74c3c;">${input}</code>
                </div>
                <div>
                    <strong>Sa√≠da (Unicode):</strong><br>
                    <span style="color: #27ae60; font-weight: bold; font-size: 18px;">${result}</span>
                </div>
            `;
        }

        // Aplicar convers√£o aos exemplos
        document.addEventListener('DOMContentLoaded', function() {
            const formulas = document.querySelectorAll('.formula .original');
            formulas.forEach(formula => {
                const converted = convertMathToUnicode(formula.textContent);
                const convertedElement = formula.nextElementSibling;
                convertedElement.textContent = converted;
            });
        });
    </script>
</body>
</html>
